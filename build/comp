#! /bin/bash

CURRENT_PATH=$PWD
echo "Current path: $CURRENT_PATH"

export BUILD_DOCS=false
while test $# -gt 0; do
        case "$1" in
                -h|--help)
                        echo "Comp - compilation script to build all of UXH"
                        echo " "
                        echo "options:"
                        echo "   -h, --help       show brief help"
                        echo "   -d, --docs       build documentation"
                        exit 0
                        ;;
                -d)
						echo "Building docs specified"
						export BUILD_DOCS=true
                        shift
                        #if test $# -gt 0; then
                        #        export PROCESS=$1
                        #else
                        #        echo "no process specified"
                        #        exit 1
                        #fi
                        #shift
                        ;;
                --docs)
                        echo "Building docs specified"
						export BUILD_DOCS=true
                        shift
                        ;;
                *)
                        break
                        ;;
        esac
done

#export TBBROOT=fdsljkfds
source /local/software/intel/2017/mkl/bin/mklvars.sh intel64 ilp64
# cmake -D CMAKE_C_COMPILER=gcc-6 -D CMAKE_CXX_COMPILER=g++-6 ..

if [ "$BUILD_DOCS" = true ] ; then
        echo "XNLO:"
        cd "$CURRENT_PATH"/../XNLO/build &&
        ./comp -d

        echo "HHGP:"
        cd "$CURRENT_PATH"/../HHGP/build &&
        ./comp -d

        echo "UPPE:"
        cd "$CURRENT_PATH"/../UPPE/build &&
        ./comp -d

        echo "UXH:"
        echo "Generating combined Docs..."
        DOXYGEN_QUIET=YES doxygen Doxyfile
else
        echo "XNLO:"
        cd "$CURRENT_PATH"/../XNLO/build &&
        ./comp 

        echo "HHGP:"
        cd "$CURRENT_PATH"/../HHGP/build &&
        ./comp 

        echo "UPPE:"
        cd "$CURRENT_PATH"/../UPPE/build &&
        ./comp 
fi
