#! /bin/bash

export BUILD_DOCS=false
while test $# -gt 0; do
        case "$1" in
                -h|--help)
                        echo "Comp - compilation script to build all of UXH"
                        echo " "
                        echo "options:"
                        echo "   -h, --help       show brief help"
                        echo "   -d, --docs       build documentation"
                        exit 0
                        ;;
                -d)
                        echo "-- HHGP building docs specified"
                        export BUILD_DOCS=true
                        shift
                        #if test $# -gt 0; then
                        #        export PROCESS=$1
                        #else
                        #        echo "no process specified"
                        #        exit 1
                        #fi
                        #shift
                        ;;
                --docs)
                        echo "-- HHGP building docs specified"
                        export BUILD_DOCS=true
                        shift
                        ;;
                *)
                        break
                        ;;
        esac
done

#export TBBROOT=fdsljkfds
source /local/software/intel/2017/mkl/bin/mklvars.sh intel64 ilp64
# cmake -D CMAKE_C_COMPILER=gcc-6 -D CMAKE_CXX_COMPILER=g++-6 ..

if [ "$BUILD_DOCS" = true ] ; then
    cmake -DBUILD_DOCS=ON -D CMAKE_C_COMPILER=mpicc -D CMAKE_CXX_COMPILER=mpic++ .. &&
    DOXYGEN_QUIET=YES make
else
    cmake -D CMAKE_C_COMPILER=mpicc -D CMAKE_CXX_COMPILER=mpic++ .. &&
    DOXYGEN_QUIET=YES make
fi

cp ../../src/HHGP/HHGP.hpp ../lib/HHGP.hpp
